# Load Data into an Instance

## Introduction

*Describe the lab in one or two sentences, for example:* This lab walks you through the steps to ...

Estimated Lab Time: &lt;n&gt; minutes

## Deploy Micronaut Application to OCI


## Create a Compute Instance for Production

This compute instance will be the machine your app will run in. We will call it "production".

1. The app will be deployed from the development VM to the production VM. From the development VM created earlier:
   1. Generate a new RSA key pair.
      ```
      ssh-keygen -t rsa -N "" -b 2048 -C "cloud_shell" -f ~/.ssh/id_rsa
      ```
   1. Display the public key and copy it.
      ```
      cat ~/.ssh/id_rsa.pub
      ```
1. Now create the production VM:
   1. Click "Create a VM instance" in the Compute box. In this lab the Compute Instance will be accessed from the Cloud Shell and a local Terminal via SSH.
      ![](images/cloudDashboard.png)
   1. The default Free Tier machine is a VM.Standard.E2.1.Micro
   1. In the **Create Compute form**, paste the public key in the SSH KEYS box.
      ![](images/computeForm2Create.png)
      If you intend to SSH into your compute instance from any other machine, you may click the "+ Another Key" button and enter the public key for that machine.  
      (you may also want to save a copy of the Cloud Shell private key '~/.ssh/id_rsa' on your local machine.)  
      **DO NOT SHARE your private key**.  This key allows access to your compute instance.
   1. Click "Create".
   1. Once the Compute instance is Running, locate the Public IP Address and click Copy.
      Keep this IP address handy, it will be used throughout the lab and referred to as \<YourProductionPublicIP>.
1. In the development SSH create an environment variable to store the IP address of the production VM.
   ```
   export PRODUCTION_IP=<YourProductionPublicIP>
   ```

### Deploy From Development VM To Production VM

TODO Fix this

1. Before deploying, ensure the wallet exists on the VM by running the snippet produced by `setup.sh` that looks similar to:

   ```shell script
   # run on local machine to push to VM
   scp -i ~/.ssh/id_oci -r /tmp/wallet opc@[VM IP Address]:/tmp/wallet
   ```

1. Build JAR with:

   ```shell script
   # run on local machine
   ./gradlew assemble
   ```

1. Push JAR to VM with the snippet produced by `setup.sh` that looks similar to this:

   ```shell script
   # run on local machine to push to VM
   scp -i ~/.ssh/id_oci -r build/libs/micronaut-data-jdbc-graal-atp-0.1-all.jar opc@[VM IP Address]:/app
   ```

1. To run on the VM, SSH in and run the snippet generated by `setup.md` that looks similar to this:

   ```shell script
   # run on VM to start application
   java -jar -DMICRONAUT_OCI_DEMO_PASSWORD [your generated password] /app/micronaut-data-jdbc-graal-atp-0.1-all.jar
   ```

## Continue through the following section

1. native-image [Native Image](native-image.md)

## Want to Learn More?

* [Oracle Cloud](http://www.oracle.com/cloud/free)
* [Oracle Live Labs](https://oracle.github.io/learning-library/developer-library/)
